(function($){function processError(a,b){b=b.replace(/%%C%%/ig,",");var c=true;switch(options.displayType){case"alert-one":alert(b);styleField(a,true);c=false;break;case"alert-all":case"display-html":returnHash.push([a,b]);break}return c}function displayHTMLErrors(a,b){var c="<div class='alert alert-error'>";c+="<a class='close' href='javascript:void(0);' onclick=\"$(this).parent('div').remove();\" data-dismiss='alert'>x</a>";c+=options.errorTextIntro+"<br /><br />";for(var d=0;d<b.length;d++){c+=options.errorHTMLItemBullet+b[d][1]+"<br />";styleField(b[d][0],d==0)}c+="</div>";if(b.length>0){$("#"+options.errorTargetElementId).css("display","block");$("#"+options.errorTargetElementId).html(c);return false}return true}function styleField(a,b){if(a.type==undefined){if(b)a[0].focus();for(var c=0;c<a.length;c++){if(!$(a[c]).hasClass(options.errorFieldClass))$(a[c]).addClass(options.errorFieldClass)}}else{if(options.errorFieldClass)$(a).addClass(options.errorFieldClass);if(b)a.focus()}}function isValidEmail(a){var b=$.trim(a);var c="@";var d=".";var e=b.indexOf(c);var f=b.length;var g=b.indexOf(d);if(b.indexOf(c)==-1||b.indexOf(c)==-1||b.indexOf(c)==0||b.indexOf(c)==f||b.indexOf(d)==-1||b.indexOf(d)==0||b.indexOf(d)==f||b.indexOf(c,e+1)!=-1||b.substring(e-1,e)==d||b.substring(e+1,e+2)==d||b.indexOf(d,e+2)==-1||b.indexOf(" ")!=-1){return false}return true}function isValidDate(a,b,c,d){var e;if(c%4==0&&(c%100!=0||c%400==0))e=[31,29,31,30,31,30,31,31,30,31,30,31];else e=[31,28,31,30,31,30,31,31,30,31,30,31];if(!a||!b||!c)return false;if(1>a||a>12)return false;if(c<0)return false;if(1>b||b>e[a-1])return false;if(d){var f=new Date;var g=f.getMonth()+1;var h=f.getDate();var i=f.getFullYear();if(String(g).length==1)g="0"+g;if(String(h).length==1)h="0"+h;var j=String(i)+String(g)+String(h);if(String(a).length==1)a="0"+a;if(String(b).length==1)b="0"+b;incomingDate=String(c)+String(a)+String(b);if(Number(j)>Number(incomingDate))return false}return true}var options={};var returnHash=[];$.fn.RSV=function(a){options=$.extend({},$.fn.RSV.defaults,a);return this.each(function(){$(this).bind("submit",{currForm:this,options:options},$(this).RSV.validate)})};$.fn.RSV.defaults={rules:[],displayType:"display-html",errorFieldClass:'ierro',errorTextIntro:"Por favor, verifique o(s) erro(s) abaixo:",errorJSItemBullet:"* ",errorHTMLItemBullet:"- ",errorTargetElementId:"rsvErrors",customErrorHandler:null,onCompleteHandler:null};$.fn.RSV.validate=function(event){options=event.data.options;var form=event.data.currForm;var rules=options.rules;returnHash=[];for(var i=0;i<rules.length;i++){var row=rules[i].replace(/\\,/ig,"%%C%%");row=row.split(",");var satisfiesIfConditions=true;while(row[0].match("^if:")){var cond=row[0];cond=cond.replace("if:","");var comparison="equal";var parts=[];if(cond.search("!=")!=-1){parts=cond.split("!=");comparison="not_equal"}else parts=cond.split("=");var fieldToCheck=parts[0];var valueToCheck=parts[1];var fieldnameValue="";if(form[fieldToCheck].type==undefined){for(var j=0;j<form[fieldToCheck].length;j++){if(form[fieldToCheck][j].checked)fieldnameValue=form[fieldToCheck][j].value}}else if(form[fieldToCheck].type=="checkbox"){if(form[fieldToCheck].checked)fieldnameValue=form[parts[0]].value}else fieldnameValue=form[parts[0]].value;if(comparison=="equal"&&fieldnameValue!=valueToCheck){satisfiesIfConditions=false;break}else if(comparison=="not_equal"&&fieldnameValue==valueToCheck){satisfiesIfConditions=false;break}else row.shift()}if(!satisfiesIfConditions)continue;var requirement=row[0];var fieldName=row[1];var fieldName2,fieldName3,errorMessage,lengthRequirements,date_flag;if(requirement!="function"&&form[fieldName]==undefined){alert('RSV Error: the field "'+fieldName+"\" doesn't exist! Please check your form and settings.");return false}if(requirement!="function"&&options.errorFieldClass){if(form[fieldName].type==undefined){for(var j=0;j<form[fieldName].length;j++){if($(form[fieldName][j]).hasClass(options.errorFieldClass))$(form[fieldName][j]).removeClass(options.errorFieldClass)}}else{if($(form[fieldName]).hasClass(options.errorFieldClass))$(form[fieldName]).removeClass(options.errorFieldClass)}}if(row.length==6){fieldName2=row[2];fieldName3=row[3];date_flag=row[4];errorMessage=row[5]}else if(row.length==5){fieldName2=row[2];fieldName3=row[3];errorMessage=row[4]}else if(row.length==4){fieldName2=row[2];errorMessage=row[3]}else errorMessage=row[2];if(requirement.match("^length")){lengthRequirements=requirement;requirement="length"}if(requirement.match("^range")){rangeRequirements=requirement;requirement="range"}switch(requirement){case"required":if(form[fieldName].type==undefined){var oneIsChecked=false;for(var j=0;j<form[fieldName].length;j++){if(form[fieldName][j].checked)oneIsChecked=true}if(!oneIsChecked){if(!processError(form[fieldName],errorMessage))return false}}else if(form[fieldName].type=="select-multiple"){var oneIsSelected=false;for(var k=0;k<form[fieldName].length;k++){if(form[fieldName][k].selected)oneIsSelected=true}if(!oneIsSelected||form[fieldName].length==0){if(!processError(form[fieldName],errorMessage))return false}}else if(form[fieldName].type=="checkbox"){if(!form[fieldName].checked){if(!processError(form[fieldName],errorMessage))return false}}else if(!form[fieldName].value){if(!processError(form[fieldName],errorMessage))return false}break;case"digits_only":if(form[fieldName].value&&form[fieldName].value.match(/\D/)){if(!processError(form[fieldName],errorMessage))return false}break;case"letters_only":if(form[fieldName].value&&form[fieldName].value.match(/[^a-zA-Z]/)){if(!processError(form[fieldName],errorMessage))return false}break;case"is_alpha":if(form[fieldName].value&&form[fieldName].value.match(/\W/)){if(!processError(form[fieldName],errorMessage))return false}break;case"custom_alpha":var conversion={L:"[A-Z]",V:"[AEIOU]",l:"[a-z]",v:"[aeiou]",D:"[a-zA-Z]",F:"[aeiouAEIOU]",C:"[BCDFGHJKLMNPQRSTVWXYZ]",x:"[0-9]",c:"[bcdfghjklmnpqrstvwxyz]",X:"[1-9]",E:"[bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ]"};var reg_exp_str="";for(var j=0;j<fieldName2.length;j++){if(conversion[fieldName2.charAt(j)])reg_exp_str+=conversion[fieldName2.charAt(j)];else reg_exp_str+=fieldName2.charAt(j)}var reg_exp=new RegExp(reg_exp_str);if(form[fieldName].value&&reg_exp.exec(form[fieldName].value)==null){if(!processError(form[fieldName],errorMessage))return false}break;case"reg_exp":var reg_exp_str=fieldName2.replace(/%%C%%/ig,",");if(row.length==5)var reg_exp=new RegExp(reg_exp_str,fieldName3);else var reg_exp=new RegExp(reg_exp_str);if(form[fieldName].value&&reg_exp.exec(form[fieldName].value)==null){if(!processError(form[fieldName],errorMessage))return false}break;case"length":comparison_rule="";rule_string="";if(lengthRequirements.match(/length=/)){comparison_rule="equal";rule_string=lengthRequirements.replace("length=","")}else if(lengthRequirements.match(/length>=/)){comparison_rule="greater_than_or_equal";rule_string=lengthRequirements.replace("length>=","")}else if(lengthRequirements.match(/length>/)){comparison_rule="greater_than";rule_string=lengthRequirements.replace("length>","")}else if(lengthRequirements.match(/length<=/)){comparison_rule="less_than_or_equal";rule_string=lengthRequirements.replace("length<=","")}else if(lengthRequirements.match(/length</)){comparison_rule="less_than";rule_string=lengthRequirements.replace("length<","")}switch(comparison_rule){case"greater_than_or_equal":if(!(form[fieldName].value.length>=parseInt(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"greater_than":if(!(form[fieldName].value.length>parseInt(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"less_than_or_equal":if(!(form[fieldName].value.length<=parseInt(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"less_than":if(!(form[fieldName].value.length<parseInt(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"equal":var range_or_exact_number=rule_string.match(/[^_]+/);var fieldCount=range_or_exact_number[0].split("-");if(fieldCount.length==2){if(form[fieldName].value.length<fieldCount[0]||form[fieldName].value.length>fieldCount[1]){if(!processError(form[fieldName],errorMessage))return false}}else{if(form[fieldName].value.length!=fieldCount[0]){if(!processError(form[fieldName],errorMessage))return false}}break}break;case"valid_email":if(form[fieldName].value&&!isValidEmail(form[fieldName].value)){if(!processError(form[fieldName],errorMessage))return false}break;case"valid_date":var isLaterDate=false;if(date_flag=="later_date")isLaterDate=true;else if(date_flag=="any_date")isLaterDate=false;if(!isValidDate(form[fieldName].value,form[fieldName2].value,form[fieldName3].value,isLaterDate)){if(!processError(form[fieldName],errorMessage))return false}break;case"same_as":if(form[fieldName].value!=form[fieldName2].value){if(!processError(form[fieldName],errorMessage))return false}break;case"range":comparison_rule="";rule_string="";if(rangeRequirements.match(/range=/)){comparison_rule="equal";rule_string=rangeRequirements.replace("range=","")}else if(rangeRequirements.match(/range>=/)){comparison_rule="greater_than_or_equal";rule_string=rangeRequirements.replace("range>=","")}else if(rangeRequirements.match(/range>/)){comparison_rule="greater_than";rule_string=rangeRequirements.replace("range>","")}else if(rangeRequirements.match(/range<=/)){comparison_rule="less_than_or_equal";rule_string=rangeRequirements.replace("range<=","")}else if(rangeRequirements.match(/range</)){comparison_rule="less_than";rule_string=rangeRequirements.replace("range<","")}switch(comparison_rule){case"greater_than_or_equal":if(!(form[fieldName].value>=Number(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"greater_than":if(!(form[fieldName].value>Number(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"less_than_or_equal":if(!(form[fieldName].value<=Number(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"less_than":if(!(form[fieldName].value<Number(rule_string))){if(!processError(form[fieldName],errorMessage))return false}break;case"equal":var rangeValues=rule_string.split("-");if(form[fieldName].value<Number(rangeValues[0])||form[fieldName].value>Number(rangeValues[1])){if(!processError(form[fieldName],errorMessage))return false}break}break;case"function":custom_function=fieldName;eval("var result = "+custom_function+"()");if(result.constructor.toString().indexOf("Array")!=-1){for(var j=0;j<result.length;j++){if(!processError(result[j][0],result[j][1]))return false}}break;default:alert("Unknown requirement flag in validateFields(): "+requirement);return false}}if(typeof options.customErrorHandler=="function")return options.customErrorHandler(form,returnHash);else if(options.displayType=="alert-all"){var errorStr=options.errorTextIntro+"\n\n";for(var i=0;i<returnHash.length;i++){errorStr+=options.errorJSItemBullet+returnHash[i][1]+"\n";styleField(returnHash[i][0],i==0)}if(returnHash.length>0){alert(errorStr);return false}}else if(options.displayType=="display-html"){var success=displayHTMLErrors(form,returnHash);if(!success)return false}if(typeof options.onCompleteHandler=="function")return options.onCompleteHandler();else return true}})(jQuery)
;
(function(a){var b=(a.browser.msie?"paste":"input")+".mask",c=window.orientation!=undefined;a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},a.fn.extend({caret:function(a,b){if(this.length!=0){if(typeof a=="number"){b=typeof b=="number"?b:a;return this.each(function(){if(this.setSelectionRange)this.setSelectionRange(a,b);else if(this.createTextRange){var c=this.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select()}})}if(this[0].setSelectionRange)a=this[0].selectionStart,b=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var c=document.selection.createRange();a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length}return{begin:a,end:b}}},unmask:function(){return this.trigger("unmask")},mask:function(d,e){if(!d&&this.length>0){var f=a(this[0]);return f.data(a.mask.dataName)()}e=a.extend({placeholder:"_",completed:null},e);var g=a.mask.definitions,h=[],i=d.length,j=null,k=d.length;a.each(d.split(""),function(a,b){b=="?"?(k--,i=a):g[b]?(h.push(new RegExp(g[b])),j==null&&(j=h.length-1)):h.push(null)});return this.trigger("unmask").each(function(){function v(a){var b=f.val(),c=-1;for(var d=0,g=0;d<k;d++)if(h[d]){l[d]=e.placeholder;while(g++<b.length){var m=b.charAt(g-1);if(h[d].test(m)){l[d]=m,c=d;break}}if(g>b.length)break}else l[d]==b.charAt(g)&&d!=i&&(g++,c=d);if(!a&&c+1<i)f.val(""),t(0,k);else if(a||c+1>=i)u(),a||f.val(f.val().substring(0,c+1));return i?d:j}function u(){return f.val(l.join("")).val()}function t(a,b){for(var c=a;c<b&&c<k;c++)h[c]&&(l[c]=e.placeholder)}function s(a){var b=a.which,c=f.caret();if(a.ctrlKey||a.altKey||a.metaKey||b<32)return!0;if(b){c.end-c.begin!=0&&(t(c.begin,c.end),p(c.begin,c.end-1));var d=n(c.begin-1);if(d<k){var g=String.fromCharCode(b);if(h[d].test(g)){q(d),l[d]=g,u();var i=n(d);f.caret(i),e.completed&&i>=k&&e.completed.call(f)}}return!1}}function r(a){var b=a.which;if(b==8||b==46||c&&b==127){var d=f.caret(),e=d.begin,g=d.end;g-e==0&&(e=b!=46?o(e):g=n(e-1),g=b==46?n(g):g),t(e,g),p(e,g-1);return!1}if(b==27){f.val(m),f.caret(0,v());return!1}}function q(a){for(var b=a,c=e.placeholder;b<k;b++)if(h[b]){var d=n(b),f=l[b];l[b]=c;if(d<k&&h[d].test(f))c=f;else break}}function p(a,b){if(!(a<0)){for(var c=a,d=n(b);c<k;c++)if(h[c]){if(d<k&&h[c].test(l[d]))l[c]=l[d],l[d]=e.placeholder;else break;d=n(d)}u(),f.caret(Math.max(j,a))}}function o(a){while(--a>=0&&!h[a]);return a}function n(a){while(++a<=k&&!h[a]);return a}var f=a(this),l=a.map(d.split(""),function(a,b){if(a!="?")return g[a]?e.placeholder:a}),m=f.val();f.data(a.mask.dataName,function(){return a.map(l,function(a,b){return h[b]&&a!=e.placeholder?a:null}).join("")}),f.attr("readonly")||f.one("unmask",function(){f.unbind(".mask").removeData(a.mask.dataName)}).bind("focus.mask",function(){m=f.val();var b=v();u();var c=function(){b==d.length?f.caret(0,b):f.caret(b)};(a.browser.msie?c:function(){setTimeout(c,0)})()}).bind("blur.mask",function(){v(),f.val()!=m&&f.change()}).bind("keydown.mask",r).bind("keypress.mask",s).bind(b,function(){setTimeout(function(){f.caret(v(!0))},0)}),v()})}})})(jQuery)